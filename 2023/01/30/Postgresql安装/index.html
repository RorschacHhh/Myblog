

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/Myblog/img/fluid.png">
  <link rel="icon" href="/Myblog/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Julius Wang">
  <meta name="keywords" content="">
  
    <meta name="description" content="PostgreSQL 安装#安装支持 yum -y install gcc automake autoconf libtool make readline-devel zlib-devel flex  #设置账号 groupadd postgres useradd -g postgres postgres passwd postgres  #设置数据文件夹 mkdir -p &#x2F;data&#x2F;pgsql">
<meta property="og:type" content="article">
<meta property="og:title" content="Postgresql安装">
<meta property="og:url" content="https://rorschachhh.github.io/Myblog/2023/01/30/Postgresql%E5%AE%89%E8%A3%85/index.html">
<meta property="og:site_name" content="Julius BLOG">
<meta property="og:description" content="PostgreSQL 安装#安装支持 yum -y install gcc automake autoconf libtool make readline-devel zlib-devel flex  #设置账号 groupadd postgres useradd -g postgres postgres passwd postgres  #设置数据文件夹 mkdir -p &#x2F;data&#x2F;pgsql">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-01-30T02:37:58.000Z">
<meta property="article:modified_time" content="2023-01-30T02:40:33.854Z">
<meta property="article:author" content="Julius Wang">
<meta property="article:tag" content="postgresql">
<meta property="article:tag" content="install">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Postgresql安装 - Julius BLOG</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/Myblog/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/Myblog/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/Myblog/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"rorschachhh.github.io","root":"/Myblog/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/Myblog/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/Myblog/js/utils.js" ></script>
  <script  src="/Myblog/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/Myblog/">
      <strong>Julius_Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/archives">
                <i class="iconfont icon-books"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/categories">
                <i class="iconfont icon-th-large"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Myblog/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-book"></i>
                <span>文档</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/">
                    
                    <span>主题博客</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/docs/guide/">
                    
                    <span>配置指南</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/docs/icon/">
                    
                    <span>图标用法</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/Myblog/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Postgresql安装"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-30 10:37" pubdate>
          2023年1月30日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          57 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Postgresql安装</h1>
            
            
              <div class="markdown-body">
                
                <p>PostgreSQL</p>
<h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><pre><code class="hljs">#安装支持
yum -y install gcc automake autoconf libtool make readline-devel zlib-devel flex

#设置账号
groupadd postgres
useradd -g postgres postgres
passwd postgres

#设置数据文件夹
mkdir -p /data/pgsql/&#123;data,log,archive&#125;
chown -R postgres.postgres /data/pgsql

#解压
tar -xzvf postgresql-12.4.tar.gz -C /usr/local/
cd /usr/local/postgresql-xxxx

#编译
./configure
make &amp; make install

#修改参数
vi /etc/security/limits.conf

postgres soft  core unlimited
postgres hard  nproc unlimited
postgres soft  nproc unlimited
postgres hard  memlock unlimited
postgres hard  nofile 1024000
postgres soft  memlock unlimited
postgres soft  nofile 1024000
postgres hard  stack  65536
postgres soft  stack  65536

#初始化数据库
su - postgres
cd /usr/local/pgsql/bin
./initdb -E utf8 -D /data/pgsql/data

#添加环境变量
vim /etc/bashrc

export PGHOME=/usr/local/pgsql/
export PGUSER=postgres
export PGPORT=5432
export PGDATA=/data/pgsql/data
export PGLOG=/data/pgsql/log/postgres.log
export PATH=$PGHOME/bin:$PATH:$HOME/bin
export LD_LIBRARY_PATH=$PGHOME/lib:$LD_LIBRARY_PATH
PATH=/usr/local/pgsql/bin:$PATH
export PATH

source /etc/bashrc

#修改数据库访问限制
vim /data/pgsql/data/postgresql.conf 
listen_addresses = &#39;*&#39;

vim /data/pgsql/data/pg_hba.conf
在文件的最下方追加如下命令（生产环境需要将其替换为远程访问数据库的IP地址或地址段） 
host all all 0.0.0.0/0 trust

#创建测试数据库
pg_ctl -D $PGDATA -l $PGLOG start
/usr/local/pgsql/bin/createdb test
/usr/local/pgsql/bin/psql test

#修改参数密码
alter user postgres with password &#39;password&#39;;
alter system set max_connections = 500;
alter system set shared_buffers = &#39;1GB&#39;; #25%内存
alter system set checkpoint_completion_target = 0.8; #数值越高IO越平滑
alter system set work_mem = &#39;16MB&#39;; #每个会话的缓存
alter system set maintenance_work_mem = &#39;1024MB&#39;; #8G一般512-1024
alter system set wal_buffers = &#39;4MB&#39;; #

#开机自启
cp /usr/local/postgresql-xxxx/contrib/start-scripts/linux /etc/init.d/postgresql
chkconfig --add postgresql
chmod 755 /etc/init.d/postgresql

#修改参数
prefix=&quot;/usr/local/pgsql&quot;
PGDATA=&quot;/data/postgresql/data&quot;
PGLOG=&quot;/data/pgsql/log/postgres.log&quot;
PGUSER=postgres

service postgresql start
</code></pre>
<h5 id="主从设置"><a href="#主从设置" class="headerlink" title="主从设置"></a>主从设置</h5><pre><code class="hljs">#安装支持
yum install flex -y

#下载安装repmgr root
wget -c https://repmgr.org/download/repmgr-5.3.0.tar.gz
mkdir /usr/local/pgsql/contrib
tar -zxvf repmgr-5.3.0.tar.gz -C /usr/local/pgsql/contrib
cd /usr/local/pgsql/contrib
mv repmgr-5.3.0/ repmgr
vim ~/.bash_profile

export PGHOME=/usr/local/pgsql
export PGUSER=postgres
export PGPORT=5432
export PGDATA=/data/pgsql/data
export PGLOG=/data/pgsql/log/postgres.log
export PATH=$PGHOME/bin:$PATH:$HOME/bin
export LD_LIBRARY_PATH=$PGHOME/lib:$LD_LIBRARY_PATH
PATH=/usr/local/pgsql/bin:$PATH:$HOME/bin
export PATH

source ~/.bash_profile
./configure&amp;&amp;make install

#设置repmgr
vim /etc/repmgr.conf

node_id=2
node_name=&#39;node2&#39;
conninfo=&#39;host=10.29.0.4 user=repmgr dbname=repmgr connect_timeout=2&#39;
data_directory=&#39;/data/pgsql/data&#39;

log_level=INFO
log_facility=STDERR
log_file=&#39;/data/pgsql/log/repmgr.log&#39;
log_status_interval=10

pg_bindir=&#39;/usr/local/pgsql/bin&#39;

#命令设置全路径
failover=&#39;automatic&#39;
promote_command=&#39;/usr/local/pgsql/bin/repmgr standby promote -f /etc/repmgr.conf --log-to-file&#39; 
follow_command=&#39;/usr/local/pgsql/bin/repmgr standby follow -f /etc/repmgr.conf --log-to-file --upstream-node-id=%n&#39;log_file=&#39;/data/pgsql/log/repmgr.log&#39;

service_start_command=&#39;sudo service postgresql start&#39;
service_stop_command=&#39;sudo service postgresql stop&#39;
service_restart_command=&#39;sudo service postgresql restart&#39;
service_reload_command=&#39;su - postgres -c \&#39;pg_ctl reload\&#39; &#39;

repmgrd_pid_file=&#39;/tmp/repmgrd.pid&#39;
repmgrd_service_start_command=&#39;/usr/local/pgsql/bin/repmgrd -f /etc/repmgr.conf start&#39;
repmgrd_service_stop_command=&#39;kill -9 `cat /tmp/repmgrd.pid`&#39;

replication_user=&#39;repmgr&#39;
use_replication_slots=true
repmgr_bindir=&#39;/usr/local/pgsql/bin&#39;
passfile=&#39;/home/postgres/.pgpass&#39;
ssh_options=&#39;-q -o ConnectTimeout=10&#39;
monitoring_history=yes
monitor_interval_secs=2
reconnect_attempts=3
reconnect_interval=5
#修改postgresql.conf
vim /data/pgsql/data/postgresql.conf

max_wal_senders = 10
max_replication_slots = 10
wal_level = replica
hot_standby = on
archive_mode = on   # repmgr 本身不需要 WAL 文件归档。
archive_command = &#39;/bin/true&#39;

#修改pg_hba.conf
vim /data/pgsql/data/pg_hba.conf
local   replication   repmgr                              trust
host    replication   repmgr      127.0.0.1/32            trust
host    replication   repmgr      10.40.16.0/23           trust

local   repmgr        repmgr                              trust
host    repmgr        repmgr      127.0.0.1/32            trust
host    repmgr        repmgr      10.40.16.0/23           trust

#在master上设置repmgr的用户和数据库
su - postgres
pg_ctl start
psql postgres

create database repmgr;
create user repmgr with password &#39;repmgr&#39; superuser login;
alter database repmgr owner to repmgr;

#设置主数据库
repmgr -f /etc/repmgr.conf primary register
repmgr -f /etc/repmgr.conf cluster show

#设置从库
repmgr -h 主库IP -U repmgr -d repmgr -f /etc/repmgr.conf standby clone -F --dry-run
repmgr -h 主库IP -U repmgr -d repmgr -f /etc/repmgr.conf standby clone -F

su - postgres
pg_ctl start -l $PGLOG
--slave1节点，将slave1数据库注册到集群，并查看状态
su - postgres -c &quot;/usr/local/pgsql/bin/repmgr -f /etc/repmgr.conf standby register&quot;
su - postgres -c &quot;/usr/local/pgsql/bin/repmgr -f /etc/repmgr.conf cluster show&quot;

#设置repmgrd.service
[Unit]
Description=A replication manager, and failover management tool for PostgreSQL
After=syslog.target
After=network.target
After=postgresql.service   #posgres服务名

[Service]
Type=forking

User=postgres
Group=postgres

# PID file
PIDFile=/tmp/repmgrd.pid

# Location of repmgr conf file:
Environment=REPMGRDCONF=/etc/repmgr.conf
Environment=PIDFILE=/tmp/repmgrd.pid

# Where to send early-startup messages from the server
# This is normally controlled by the global default set by systemd
# StandardOutput=syslog
ExecStart=/usr/local/pgsql/bin/repmgrd -f $&#123;REPMGRDCONF&#125; -p $&#123;PIDFILE&#125; -d --verbose
ExecStop=/usr/bin/kill -TERM $MAINPID
ExecReload=/usr/bin/kill -HUP $MAINPID

# Give a reasonable amount of time for the server to start up/shut down
TimeoutSec=300

[Install]
WantedBy=multi-user.target

#主从恢复
service postgresql stop
su - postgres -c &quot;repmgr -h 10.29.0.3 -U repmgr -d repmgr -f /etc/repmgr.conf standby clone -F&quot;
service postgresql start
su - postgres -c &quot;repmgr -f /etc/repmgr.conf standby register -F&quot;
su - postgres -c &quot;repmgr service status&quot;
</code></pre>
<h5 id="故障排除"><a href="#故障排除" class="headerlink" title="故障排除"></a>故障排除</h5><pre><code class="hljs">#主备无法切换
检查是否有sudo权限并设置免密
vim /etc/sudoers
查看配置文件命令是否是全路径
vim /etc/repmgr.conf
查看节点状态是否是Paused状态
repmgr service status
</code></pre>
<h4 id="8-keepalived"><a href="#8-keepalived" class="headerlink" title="8.keepalived"></a>8.keepalived</h4><h5 id="VIP设置"><a href="#VIP设置" class="headerlink" title="VIP设置"></a>VIP设置</h5><pre><code class="hljs">#防火墙
 firewall-cmd --zone=public --add-protocol=vrrp --permanent
 firewall-cmd --reload

#设置keepalived.conf
    ! Configuration File for keepalived

    global_defs &#123;
       router_id 节点名
    &#125;

    vrrp_script pg_check &#123;
        script &quot;/etc/keepalived/pg_check.sh&quot; #设置脚本，不是主权重 -3
        weight -3
    &#125;

    vrrp_instance VI_1 &#123;
        interface ens192 #绑定网卡
        virtual_router_id 56
        priority 92     #主备权重可以一样也可以不一样
        advert_int 1  #每秒check
        authentication &#123;
            auth_type PASS
            auth_pass 39hgoDQP
        &#125;
        virtual_ipaddress &#123;
            10.29.0.7  #虚拟ip
        &#125;
       track_script &#123;
            pg_check   #执行脚本
       &#125;
    &#125;

#执行脚本
#!/bin/bash
A=`ps -ef | grep &quot;postgres:&quot; | grep &quot;walwriter&quot; | wc -l` 
B=`ps -ef | grep &quot;postgres:&quot; | grep &quot;archiver last was&quot; | wc -l`
if [ $A -ne &quot;0&quot; ] &amp;&amp; [ $B -ne &quot;0&quot; ]; then
#       /usr/bin/sudo systemctl start keepalived.service
        echo &quot;is master&quot;
        exit 0
else
#       /usr/bin/sudo killall keepalived
        echo &quot;not master&quot;
        exit 1
fi
</code></pre>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/Myblog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="category-chain-item">数据库</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/Myblog/tags/postgresql/">#postgresql</a>
      
        <a href="/Myblog/tags/install/">#install</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Postgresql安装</div>
      <div>https://rorschachhh.github.io/Myblog/2023/01/30/Postgresql安装/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Julius Wang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年1月30日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/Myblog/2023/01/30/sex/" title="sex">
                        <span class="hidden-mobile">sex</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/Myblog/js/events.js" ></script>
<script  src="/Myblog/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/Myblog/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/Myblog/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/love.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxingxing.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxuehua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/Myblog/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
